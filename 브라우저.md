## 브라우저란?
> 웹 브라우저는 동기(Synchronous)적으로 (HTML + CSS), Javascript 언어를 해석하여 내용을 화면에 보여주는 응용 소프트웨어이다.

웹 브라우저가 웹 서버에 필요한 자원(웹 페이지)을 요청하면 서버는 응답하고 웹 브라우저는 이를 해석한 후 사용자(Client)에게 보여준다. 보통 자원은 HTML 문서지만 PDF, 이미지 등 다양한 형태일 수 있다.

## 브라우저의 구조
![image](https://user-images.githubusercontent.com/90598408/160516435-49f6277f-1ad4-45c2-ad61-5fd19e012057.png)
출처 https://d2.naver.com/helloworld/59361

#### 사용자 인터페이스  
사용자가 접근할 수 있는 영역이다. URI를 입력할 수 있는 주소 표시줄, 이전/다음 버튼, 북마크 메뉴, 새로 고침 버튼과 현재 문서의 로드를 중단할 수 있는 정지 버튼 , 홈 버튼 등 요청한 페이지를 보여주는 창을 제외한 나머지 모든 부분이다.
#### 브라우저 엔진 
`사용자 인터페이스와 렌더링 엔진 사이의 동작을 제어`한다. Data Storage를 참조하며 로컬에 데이터를 쓰고 읽으면서 다양한 작업을 한다. 
#### 렌더링 엔진 
`웹 서버로부터 응답 받은 자원을 웹 브라우저 상에 나타낸다.` 예를 들어 HTML 문서를 응답받으면 HTML과 CSS를 파싱 하여 화면에 표시한다. 브라우저의 동작 원리를 이해하려면 렌더링 엔진의 이해가 중요하다. 
브라우저는 서버로부터 HTML 문서를 응답받으면 렌더링 엔진의 HTML 파서와 CSS 파서에 의해 파싱(parsing)되어 DOM, CSSOM 트리로 변환되고 렌더 트리로 결합한다. 이렇게 생성된 렌더 트리를 기반으로 브라우저는 웹 페이지를 나타낸다. 
#### 통신
HTTP 요청과 같은, 서버와 통신이 가능하게 하는 네트워크 호출에 사용된다. 
#### UI 백엔드 
select, input 등 기본적인 위젯을 그리는 인터페이스이다.
#### 자바스크립트 해석기
자바스크립트 코드를 해석하고 실행한다. 
#### 자료 저장소
Cookie, Local Storage, Indexed DB 등 브라우저 메모리를 활용하여 저장하는 영역이다.

## 렌더링 엔진과 동작
>렌더링 엔진은 HTML, XML, 이미지 등 요청받은 내용을 브라우저 화면에 표시하는 엔진이다.  

렌더링 엔진은 서버로부터 응답받은 HTML 문서를 얻는 것으로 시작합니다. 이 문서의 내용은 보통 8KB 단위로 전송됩니다.
>![image](https://user-images.githubusercontent.com/90598408/160517710-41c2f065-b1a4-42f5-b908-7fb49ce0b405.png)  
렌더링 엔진 동작 과정, 출처 = https://d2.naver.com/helloworld/59361

>① 렌더링 엔진은 HTML 문서를 파싱 하여 DOM 트리를 구축합니다.  
② 그다음 외부 CSS 파일과 함께 포함된  스타일 요소를 파싱 합니다.  
③ DOM 트리와 ②의 결과물을 합쳐 렌더 트리를 구축합니다.   
④ 렌더 트리 각 노드에 대해 화면 상에서 배치할 곳을 결정합니다.  
⑤ UI 백엔드에서 렌더 트리의 각 노드를 그립니다.  

### ① HTML 문서를 파싱 하여 DOM(Document Object Model) 트리를 구축합니다.  

DOM은 마크업과 1:1 관계를 성립합니다. 
```
 <html>
  <body>
   <p>Hello World</p>
   <div><img src="example.png" /></div>
  </body>
</html>
```

 위와 같은 코드는 아래와 같은 DOM 트리로 변환할 수 있습니다. 
 ![image](https://user-images.githubusercontent.com/90598408/160519261-2655387f-919e-4ec6-af70-cfdfaa622a46.png)


위 예제에 해당하는 DOM 트리
 브라우저는 서버로부터 HTML 문서를 모두 전달받고 HTML 파서를 통하여 파싱(parsing)하고 파싱 트리를 생성합니다. 생성된 파싱 트리를 기반으로 DOM 트리를 생성합니다.

 

 

### ② CSSOM(Css Object Model)을 생성합니다.  
![image](https://user-images.githubusercontent.com/90598408/160519308-d766e834-aa83-4064-a013-8e6b1e4f0700.png)
(CSS파싱)

CSS 파일은 스타일 시트 객체로 파싱 되고 각 객체는 CSS 규칙을 포함합니다. CSS 규칙 객체(CSSOM)는 선택자와 선언 객체 그리고 CSS 문법과 일치하는 다른 객체를 포함합니다.

 

 

### ③ 렌더 트리(DOM + CSSOM)를 생성합니다.  
DOM 트리가 구축되는 동안 브라우저는 DOM 트리를 기반으로 렌더 트리를 생성합니다. 렌더 트리는 문서를 시각적인 구성 요소로 만들어주는 역할을 합니다. 
웹킷은 이 구성 요소를 "렌더러(rendere)" 또는 "렌더 객체(render object)"라는 용어를 사용합니다. 렌더러는 자신과 자식 요소를 어떻게 배치하고 그려내야 하는지 알고 있습니다. 
렌더러는 DOM 요소에 부합하지만 1:1로 대응하는 관계는 아닙니다. 그 이유는 <head>, display:'none'와 같은 사용자가 볼 수 없는 DOM 요소는 렌더 트리에 추가되지 않습니다. (visibility 속성에 "hidden" 값이 할당된 요소는 트리에 나타납니다.)
![image](https://user-images.githubusercontent.com/90598408/160519425-12938b75-7dc7-4f70-85bd-31a83fdadf14.png)
(좌) DOM 트리 (우) 렌더 트리, "뷰포트"는 최초의 블록. 웹킷에서는 "RenderView"객체가 이 역할을 한다.  
 
### ④ 렌더 트리를 배치합니다. (레이아웃)
렌더 트리는 위치와 크기를 가지고 있지 않기 때문에, 어느 공간에 위치해야 할지 각 객체들에게 위치(position)와 크기(size)를 결정해줍니다. 

### ⑤ 렌더 트리를 그립니다. 
렌더 트리가 만들어져 레이아웃이 구성되었으면 UI 백엔드가 동작하여 렌더 트리의 각 객체를 화면의 픽셀(px) 값으로 나타냅니다. 

